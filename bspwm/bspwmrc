#! /bin/sh

pgrep -x sxhkd > /dev/null || sxhkd &

$HOME/.config/polybar/launch.sh &

# Compositor picom
picom --backend glx &
pulseaudio &

# Start session
lxsession &

# x-commands
# keyboard layout colemak and repetitive CapsLock/Backspace presses
setxkbmap us -variant colemak &

# sudo kmonad ~/testing/colemak-extend-iso.kbd &
xset r 66 & # set repetitive backspace on CapsLock
xset r rate 180 85 & # set repetitive keyboardpresses faster

# set tapping and natural scrolling on touchpad
xinput set-prop 12 "libinput Tapping Enabled" 1 &
xinput set-prop 12 "libinput Natural Scrolling Enabled" 1 &
xinput set-prop 17 "libinput Tapping Enabled" 1 &
xinput set-prop 17 "libinput Natural Scrolling Enabled" 1 &

# set cursor
xsetroot -cursor_name crosshair &

# set screen timeout
xset s 600 5 &
xss-lock -n /usr/lib/xsecurelock/dimmer -l -- xsecurelock &

# first add all the wallpapers then apply a random wallpaper including the theme
wpg -s ~/.config/wallpapers &
# spicetify apply
pywal-discord -t abou &
bash /home/kimil/.config/bspwm/bspwm_colors.sh &

# start clients like clipmenu, dunst, vpn etc 
clipmenud &
dunst &
mullvad connect &

# start spotifyd clients
spotifyd --no-daemon --device-name spotifydDellXPS15 &

# copied from https://github.com/microsoft/vscode/issues/120392#issuecomment-814210643 for github auth in vscode/vscode-insiders for setting-sync etc
# init keyring
# eval $(/usr/bin/gnome-keyring-daemon --start --components=gpg,pkcs11,secrets,ssh)
# export keyring
# export GNOME_KEYRING_CONTROL GNOME_KEYRING_PID GPG_AGENT_INFO SSH_AUTH_SOCK
# exec dbus-launch dwm


bspc monitor -d I II III IV V VI VII VIII IX X

bspc config border_width         0
bspc config window_gap          12

bspc config split_ratio          0.5
bspc config borderless_monocle   true
bspc config gapless_monocle      true

# to move and resize floating windows with my pointer and the super key
bspc config pointer_modifier mod4
bspc config pointer_action1 move
bspc config pointer_action2 resize_side
bspc config pointer_action2 resize_corner


# configurations in external rules file
# bspc config external_rules_command "${HOME}/.config/bspwm/external_rules"

# bspc rule -a Spotify desktop='^10'
bspc rule -a firefox dektop='^3' follow=on
bspc rule -a Firefox dektop='^3' follow=on
bash /home/kimil/.config/bspwm/bspwm_colors.sh &
